(* $Id: tvector.ml,v 1.3 2007-08-22 16:56:56 colonna Exp $ *)

open Gentest;;
open Vector;;

testing "Vector";;

let vector_v = [|1.0; 2.0; 3.0; 4.0|];;
let vector_w = [|1.0; 1.0; 1.0; 1.0|];;
let vector_x = [|1.0; 2.0|];;
let vector_y = [|3.0; 4.0|];;

testi 0 (
Vector.length [|1.0; 2.0|] = 2
);;

testi 1 (
Vector.minus [|1.0; 2.0|] = [|-1.0; -2.0|]
);;

testi 2 (
Vector.addition [|1.0; 2.0|]  [|-1.0; -2.0|] = zero 2
);;

testi 3 (
Vector.difference [|1.0; 2.0|]  [|1.0; 2.0|] = zero 2
);;

testi 4 (
Vector.unity 2 = [|1.; 1.|]
);;

testi 5 (
Vector.unity_ith 2 4 = [|0.; 0.; 1.; 0.|]
);;

testi 6 (
Vector.sum_fun_on_i (fun x -> 2. *. x) [|1.; 2.|] = 6.0
);;

testi 7 (
Vector.modulus [|1.0; 2.0|] = sqrt 5.0
);;

testi 8 (
Vector.norm [|1.0; 2.0|] = modulus [|1.0; 2.0|]
);;

testi 9 (
Vector.norm_2 [|1.0; 2.0|] = 5.0
);;

testi 10 (
Vector.array_of_vector_pair [|1.0; 2.0|]  [|-1.0; -2.0|] =
[|(1., -1.); (2., -2.)|]
);;

testi 11 (
Vector.dividing [|1.0; 2.0|] 2.0 =  [|0.5; 1.0|]
);;

testi 12 (
Vector.scaling [|1.0; 2.0|] 0.5 =  [|0.5; 1.0|] 
);;

testi 13 (
Vector.pair_product [|1.0; 2.0|]  [|-1.0; -2.0|] = [|-1.; -4.|]
);;

testi 14 (
Vector.dot_product [|1.0; 2.0|]  [|-1.0; -2.0|] = -5.0
);;

testi 15 (
Vector.tensor_product [|1.0; 2.0|]  [|-1.0; -2.0|] =
[| [|-1.; -2.|]; 
   [|-2.; -4.|] |]
);;

testi 16 (
Vector.center_of_mass [ (1.0, [|1.0; 2.0|]); (1.0, [|1.0; 2.0|]) ] =
[|1.; 2.|]
);;


